<!doctype html><html lang=zh-cn><meta charset=utf-8><meta name=generator content="Hugo 0.64.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><meta name=keywords content="提权,工具"><meta name=description content="此工具是一款非常好用的Windows下提权辅助工具(已经支持Windows 10下的提权了)，国内已经有许多人在用了，但是一直没有相应的中文文档，所以我特地翻译了一下，水平有限，如有错误，欢迎指出，谢谢。"><title>工具推荐：Windows-Exploit-Suggester（Windows下提权辅助工具）&nbsp;&ndash;&nbsp;WTFSec</title><link rel=stylesheet href=/css/core.min.58bc4672a8045a0810ba4ad30a08c6d5589db1109ca0aa2e07c5e5438201ea8d11642ffa31d8ee7665d6a1b66ab9a3c5.css integrity=sha384-WLxGcqgEWggQukrTCgjG1VidsRCcoKouB8XlQ4IB6o0RZC/6MdjudmXWobZquaPF><meta name=twitter:card content="summary"><meta name=twitter:title content="工具推荐：Windows-Exploit-Suggester（Windows下提权辅助工具）"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">WTFSec</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>分类</a><a class="nav item" href=/tags/>标签</a><a class="nav item" href=/link/>友链</a>
<input placeholder="Google 站内搜索" id=search_input style=width:150px>
<button onclick=search()><svg width="13" height="13" viewBox="0 0 13 13"><title>搜尋</title><path d="m4.8495 7.8226c.82666.0 1.5262-.29146 2.0985-.87438.57232-.58292.86378-1.2877.87438-2.1144.010599-.82666-.28086-1.5262-.87438-2.0985-.59352-.57232-1.293-.86378-2.0985-.87438-.8055-.010599-1.5103.28086-2.1144.87438-.60414.59352-.8956 1.293-.87438 2.0985.021197.8055.31266 1.5103.87438 2.1144.56172.60414 1.2665.8956 2.1144.87438zm4.4695.2115 3.681 3.6819-1.259 1.284-3.6817-3.7.0019784-.69479-.090043-.098846c-.87973.76087-1.92 1.1413-3.1207 1.1413-1.3553.0-2.5025-.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239.4696-2.4966 1.4088-3.4239c.9392-.92727 2.0864-1.3969 3.4417-1.4088 1.3553-.011889 2.4906.45771 3.406 1.4088.9154.95107 1.379 2.0924 1.3909 3.4239.0 1.2126-.38043 2.2588-1.1413 3.1385l.098834.090049z"/></svg></button></nav></div><script>function search(){const search_value=document.getElementById("search_input").value;if(search_value!==''){window.open("/search/?q="+search_value,"_blank");}}
document.getElementById("search_input").addEventListener("keydown",function(e){if(e.key==="Enter"){search()}});</script></span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">工具推荐：Windows-Exploit-Suggester（Windows下提权辅助工具）</h1><p class="article date"><span class=lang><a>Hzllaga</a> </span>Friday, August 25, 2017</p></section><article class="article markdown-body"><p><img src=https://cdn.wtfsec.org/img/20200222165340.jpg alt></p><p>此工具是一款非常好用的Windows下提权辅助工具(已经支持Windows 10下的提权了)，国内已经有许多人在用了，但是一直没有相应的中文文档，所以我特地翻译了一下，水平有限，如有错误，欢迎指出，谢谢。</p><h2 id=描述>描述</h2><p>该工具可以将目标系统的补丁安装情况与微软的漏洞数据库进行对比，进而检测出目标系统中潜在的未修复漏洞。同时此工具还会告知用户针对于此漏洞是否有公开的exp和可用的Metasploit模块。</p><p>同时它可以使用–update参数去自动化地从微软下载漏洞补丁数据库，并将其以Excel表格的形式保存。</p><p>需要注意的是，此工具首先会假定目标系统存在所有漏洞，然后再基于系统补丁情况去选择性的移除已修补漏洞。故此工具可能会造成一些误报，因此你首先需要了解目标机器安装了哪些软件。例如，如果此机器没有IIS的补丁，即使机器上没有IIS，工具也同样会认为存在此漏洞。</p><p>此工具很大程度上受了Pentura的Linux_Exploit_Suggester的启发。</p><h2 id=使用方法>使用方法</h2><ol><li>首先需要更新漏洞数据库<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>$ ./windows-exploit-suggester.py --update
<span class=o>[</span>*<span class=o>]</span> initiating...
<span class=o>[</span>*<span class=o>]</span> successfully requested base url
<span class=o>[</span>*<span class=o>]</span> scraped ms download url
<span class=o>[</span>+<span class=o>]</span> writing to file 2014-06-06-mssb.xlsx
<span class=o>[</span>*<span class=o>]</span> <span class=k>done</span></code></pre></div></li><li>然后安装程序依赖：<a href=https://pypi.org/project/xlrd/ target=_blank>python-xlrd</a><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>watcher@ubuntu:~/xlrd-0.9.4/xlrd-0.9.4$ sudo python setup.py install
<span class=o>[</span>sudo<span class=o>]</span> password <span class=k>for</span> watcher: 
running install
running build
running build_py
running build_scripts
running install_lib
creating /usr/local/lib/python2.7/dist-packages/xlrd
copying build/lib.linux-x86_64-2.7/xlrd/compdoc.py -&gt; /usr/local/lib/python2.7/dist-packages/xlrd
......</code></pre></div></li><li>接着在目标机器中执行systeminfo，并将其输出到文件中，然而带入参数–systeminfo中，并指定数据库位置(就是那个excel文件)<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>$ ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --systeminfo win7sp1-systeminfo.txt 
<span class=o>[</span>*<span class=o>]</span> initiating...
<span class=o>[</span>*<span class=o>]</span> database file detected as xls or xlsx based on extension
<span class=o>[</span>*<span class=o>]</span> reading from the systeminfo input file
<span class=o>[</span>*<span class=o>]</span> querying database file <span class=k>for</span> potential vulnerabilities
<span class=o>[</span>*<span class=o>]</span> comparing the <span class=m>15</span> hotfix<span class=o>(</span>es<span class=o>)</span> against the <span class=m>173</span> potential bulletins<span class=o>(</span>s<span class=o>)</span>
<span class=o>[</span>*<span class=o>]</span> there are now <span class=m>168</span> remaining vulns
<span class=o>[</span>+<span class=o>]</span> windows version identified as <span class=s1>&#39;Windows 7 SP1 32-bit&#39;</span>
<span class=o>[</span>*<span class=o>]</span> 
<span class=o>[</span>M<span class=o>]</span> MS14-012: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2925418<span class=o>)</span> - Critical
<span class=o>[</span>E<span class=o>]</span> MS13-101: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege <span class=o>(</span>2880430<span class=o>)</span> - Important
<span class=o>[</span>M<span class=o>]</span> MS13-090: Cumulative Security Update of ActiveX Kill Bits <span class=o>(</span>2900986<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-080: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2879017<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-069: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2870699<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-059: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2862772<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-055: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2846071<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-053: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Remote Code Execution <span class=o>(</span>2850851<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-009: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2792100<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege <span class=o>(</span>2778930<span class=o>)</span> - Important
<span class=o>[</span>*<span class=o>]</span> <span class=k>done</span></code></pre></div>下面这条指令可以列出指定操作系统版本存在的所有可能EXP(假设目标系统没有打任何补丁)<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>$ ./windows-exploit-suggester.py --database 2014-06-06-mssb.xlsx --ostext <span class=s1>&#39;windows server 2008 r2&#39;</span> 
<span class=o>[</span>*<span class=o>]</span> initiating...
<span class=o>[</span>*<span class=o>]</span> database file detected as xls or xlsx based on extension
<span class=o>[</span>*<span class=o>]</span> getting OS information from <span class=nb>command</span> line text
<span class=o>[</span>*<span class=o>]</span> querying database file <span class=k>for</span> potential vulnerabilities
<span class=o>[</span>*<span class=o>]</span> comparing the <span class=m>0</span> hotfix<span class=o>(</span>es<span class=o>)</span> against the <span class=m>196</span> potential bulletins<span class=o>(</span>s<span class=o>)</span>
<span class=o>[</span>*<span class=o>]</span> there are now <span class=m>196</span> remaining vulns
<span class=o>[</span>+<span class=o>]</span> windows version identified as <span class=s1>&#39;Windows 2008 R2 64-bit&#39;</span>
<span class=o>[</span>*<span class=o>]</span> 
<span class=o>[</span>M<span class=o>]</span> MS13-009: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>2792100<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS13-005: Vulnerability in Windows Kernel-Mode Driver Could Allow Elevation of Privilege <span class=o>(</span>2778930<span class=o>)</span> - Important
<span class=o>[</span>E<span class=o>]</span> MS11-011: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege <span class=o>(</span>2393802<span class=o>)</span> - Important
<span class=o>[</span>M<span class=o>]</span> MS10-073: Vulnerabilities in Windows Kernel-Mode Drivers Could Allow Elevation of Privilege <span class=o>(</span>981957<span class=o>)</span> - Important
<span class=o>[</span>M<span class=o>]</span> MS10-061: Vulnerability in Print Spooler Service Could Allow Remote Code Execution <span class=o>(</span>2347290<span class=o>)</span> - Critical
<span class=o>[</span>E<span class=o>]</span> MS10-059: Vulnerabilities in the Tracing Feature <span class=k>for</span> Services Could Allow Elevation of Privilege <span class=o>(</span>982799<span class=o>)</span> - Important
<span class=o>[</span>E<span class=o>]</span> MS10-047: Vulnerabilities in Windows Kernel Could Allow Elevation of Privilege <span class=o>(</span>981852<span class=o>)</span> - Important
<span class=o>[</span>M<span class=o>]</span> MS10-002: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>978207<span class=o>)</span> - Critical
<span class=o>[</span>M<span class=o>]</span> MS09-072: Cumulative Security Update <span class=k>for</span> Internet Explorer <span class=o>(</span>976325<span class=o>)</span> - Critical</code></pre></div></li></ol><h2 id=许可>许可</h2><p>本程序为自由软件；您可依据自由软件基金会所发表的GNU 通用公共授权条款，对本程序再次发布和/ 或修改；无论您依据的是本授权的第三版，或（您可选的）任一日后发行的版本。</p><p>本程序是基于使用目的而加以发布，然而不负任何担保责任；亦无对适售性或特定目的适用性所为的默示性担保。详情请参照GNU 通用公共授权。</p><p>您应已收到附随于本程序的GNU 通用公共授权的副本；如果没有，请参照<a href=http://www.gnu.org/licenses/ target=_blank>http://www.gnu.org/licenses/</a></p><hr>* 参考来源：github、gdssecurity，watcher编译，文章来自FreeBuff黑客与极客(FreeBuf.COM)</article><section class="article labels"><a class=category href=/categories/%E8%BD%AC%E8%BD%BD/>转载</a><a class=tag href=/tags/%E6%8F%90%E6%9D%83/>提权</a><a class=tag href=/tags/%E5%B7%A5%E5%85%B7/>工具</a></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/posts/linux%E4%B8%8Bnginx%E4%B8%8D%E6%94%AF%E6%8C%81%E4%B8%AD%E6%96%87url%E8%B7%AF%E5%BE%84%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/><span class=li>&rarr;</span>linux下nginx不支持中文URL路径的解决方案</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>©2014-2020 WTFSec.</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p><p class=powerby><span>CDN by </span><a href=https://cf.wtfsec.org target=_blank>Cloudflare</a><span> and </span><a href="https://console.upyun.com/register/?invite=H1xhvqTVV" target=_blank>又拍云</a></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-83215806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script data-ad-client=ca-pub-4220670081232153 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></body></html>