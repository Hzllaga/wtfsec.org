<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.64.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Bayonet 搭建折腾记录&nbsp;&ndash;&nbsp;WTFSec</title><link rel=stylesheet href=/css/core.min.805532cf9875da8b5e05e28993cdaa5eaf6cb6fd1e14df60b32344efecb93dba87ec77e53ac2336494eb82526410e16c.css integrity=sha384-gFUyz5h12oteBeKJk82qXq9stv0eFN9gsyNE7+y5PbqH7HflOsIzZJTrglJkEOFs><body><div class=base-body><section id=header class="site header"><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">WTFSec</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>分类</a><a class="nav item" href=/tags/>标签</a><a class="nav item" href=/link/>友链</a>
<input placeholder="Google 站内搜索" id=search_input style=width:150px>
<button onclick=search()><svg width="13" height="13" viewBox="0 0 13 13"><title>搜尋</title><path d="m4.8495 7.8226c.82666.0 1.5262-.29146 2.0985-.87438.57232-.58292.86378-1.2877.87438-2.1144.010599-.82666-.28086-1.5262-.87438-2.0985-.59352-.57232-1.293-.86378-2.0985-.87438-.8055-.010599-1.5103.28086-2.1144.87438-.60414.59352-.8956 1.293-.87438 2.0985.021197.8055.31266 1.5103.87438 2.1144.56172.60414 1.2665.8956 2.1144.87438zm4.4695.2115 3.681 3.6819-1.259 1.284-3.6817-3.7.0019784-.69479-.090043-.098846c-.87973.76087-1.92 1.1413-3.1207 1.1413-1.3553.0-2.5025-.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239.4696-2.4966 1.4088-3.4239c.9392-.92727 2.0864-1.3969 3.4417-1.4088 1.3553-.011889 2.4906.45771 3.406 1.4088.9154.95107 1.379 2.0924 1.3909 3.4239.0 1.2126-.38043 2.2588-1.1413 3.1385l.098834.090049z"/></svg></button></nav></div><script>function search(){const search_value=document.getElementById("search_input").value;if(search_value!==''){window.open("/search/?q="+search_value,"_blank");}}
document.getElementById("search_input").addEventListener("keydown",function(e){if(e.key==="Enter"){search()}});</script></span></div></section><div id=content><section class="article header"><h1 class="article title">Bayonet 搭建折腾记录</h1><p class="article date"><span class=lang><a>此生等不到表哥一句我带你</a> </span>Monday, February 24, 2020</p></section><article class="article markdown-body"><p>搭建了一个bayonet 记录下踩过的各种坑</p><blockquote><p>bayonet是一款src资产管理系统，从子域名、端口服务、漏洞、爬虫等一体化的资产管理系统</p></blockquote><p><a href=https://github.com/CTF-MissFeng/bayonet target=_blank>https://github.com/CTF-MissFeng/bayonet</a></p><p>搭建环境全部在Ubuntu上完成
git获取bayonet</p><pre><code>git clone https://github.com/CTF-MissFeng/bayonet
</code></pre><p>安装postgresql</p><pre><code>sudo apt-get install postgresql postgresql-client
</code></pre><p>安装完毕后 把数据库链接写入到WebConfig.py中 顺便把shodan的key也写进去</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224003827.png><img src=https://cdn.wtfsec.org/img/20200224003827.png alt></a></p><p>要修改数据库密码 参照<a href=https://www.cnblogs.com/wuling129/p/4917574.html target=_blank>https://www.cnblogs.com/wuling129/p/4917574.html</a></p><p>然后新建bayonet库，在psql终端里</p><pre><code>CREATE DATABASE bayonet;
</code></pre><p>运行一下app.py 注释掉最后运行函数 如果没报错数据库就链接成功了</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224003931.png><img src=https://cdn.wtfsec.org/img/20200224003931.png alt></a></p><p>再注释掉前三个 运行最后一个app函数 如果是搭建在外网可以像图片里一样绑定host</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224003948.png><img src=https://cdn.wtfsec.org/img/20200224003948.png alt></a></p><p>运行app.py 如果各种依赖库没问题，那么会像下图一样启动一个web端。默认用户名为: <code>root/qazxsw@123</code></p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224004008.png><img src=https://cdn.wtfsec.org/img/20200224004008.png alt></a></p><p>接下来安装需要的各种库</p><pre><code>pip3 install -r requirements.txt
</code></pre><p>安装crawlergo以及Chromium浏览器</p><pre><code>wget https://github.com/0Kee-Team/crawlergo/releases/download/v0.2.0/crawlergo_linux_amd64.zip
wget https://commondatastorage.googleapis.com/chromium-browser-snapshots/Linux_x64/728511/chrome-linux.zip
</code></pre><p>安装Chromium需要的依赖</p><pre><code>apt install -yq --no-install-recommends libasound2 libatk1.0-0 libc6 libcairo2 libcups2 libdbus-1-3 libexpat1 libfontconfig1 libgcc1 libgconf-2-4 libgdk-pixbuf2.0-0 libglib2.0-0 libgtk-3-0 libnspr4 libpango-1.0-0 libpangocairo-1.0-0 libstdc++6 libx11-6 libx11-xcb1 libxcb1 libxcursor1 libxdamage1 libxext6 libxfixes3 libxi6 libxrandr2 libxrender1 libxss1 libxtst6 libnss3
</code></pre><p>将chromium的可执行文件路径填到/bayonet/tools/scan/Chromium/下的Run.py中
w13scan这里踩了好久的坑,ssl模块openssl一直报错,重装好几个版本都不行。最后重装了一遍w13scan的所有库
<a href=https://github.com/w-digital-scanner/w13scan/blob/master/requirements.txt target=_blank>https://github.com/w-digital-scanner/w13scan/blob/master/requirements.txt</a></p><p>所有环境装完以后准备跑起来
先添加域名</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224004152.png><img src=https://cdn.wtfsec.org/img/20200224004152.png alt></a></p><p>接下来分别执行oneforall，portscan，Chromium，w13scan目录下的Run.py
我这里用bash一键运行全部挂到进程处理，一定要加上绝对路径</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224004208.png><img src=https://cdn.wtfsec.org/img/20200224004208.png alt></a></p><p>当然没法实时看到各个模块的信息了 不嫌麻烦可以开四个screen进程随时观察
附一张结果图,还是挺强的,跟xray比起来不逞多让。</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224004225.png><img src=https://cdn.wtfsec.org/img/20200224004225.png alt></a></p><p>最后说一句</p><h2 id=全部要用python3>全部要用python3</h2><h2 id=crawlergo-永远滴神>crawlergo 永远滴神！！！</h2><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200224004243.png><img src=https://cdn.wtfsec.org/img/20200224004243.png alt></a></p><section class="article labels"><a class=category href=/categories/%E5%8E%9F%E5%88%9B/>原创</a><a class=tag href=/tags/%E6%8A%95%E7%A8%BF/>投稿</a><a class=tag href=/tags/%E7%AC%94%E8%AE%B0/>笔记</a></section></article><div class="article navigation"><p><a class=link href=/posts/xss-hunter%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95/><span class=li>&larr;</span>XSS Hunter平台搭建记录</a><p><a class=link href=/posts/%E5%85%8D%E6%9D%80shellcode%E5%B9%B6%E7%BB%95%E8%BF%87%E6%9D%80%E6%AF%92%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%90%AF%E5%8A%A8/><span class=li>&rarr;</span>免杀shellcode并绕过杀毒添加自启动</a></p></div></div><section id=footer class=footer><div class=footer-wrap><p class=copyright>©2014-2020 WTFSec.</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p><p class=powerby><span>CDN by </span><a href=https://cf.wtfsec.org target=_blank>Cloudflare</a><span> and </span><a href="https://console.upyun.com/register/?invite=H1xhvqTVV" target=_blank>又拍云</a></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-83215806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script data-ad-client=ca-pub-4220670081232153 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></div></body></html>