<!doctype html><html lang=zh><meta charset=utf-8><meta name=generator content="Hugo 0.64.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>VMware虚拟机Kali连接ACR122U遇到的各种坑总结&nbsp;&ndash;&nbsp;WTFSec</title><link rel=stylesheet href=/css/core.min.805532cf9875da8b5e05e28993cdaa5eaf6cb6fd1e14df60b32344efecb93dba87ec77e53ac2336494eb82526410e16c.css integrity=sha384-gFUyz5h12oteBeKJk82qXq9stv0eFN9gsyNE7+y5PbqH7HflOsIzZJTrglJkEOFs><body><div class=base-body><section id=header class="site header"><div class="header wrap"><span class="header left-side"><a class="site home" href=/><span class="site name">WTFSec</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/categories/>分类</a><a class="nav item" href=/tags/>标签</a><a class="nav item" href=/link/>友链</a>
<input placeholder="Google 站内搜索" id=search_input style=width:150px>
<button onclick=search()><svg width="13" height="13" viewBox="0 0 13 13"><title>搜尋</title><path d="m4.8495 7.8226c.82666.0 1.5262-.29146 2.0985-.87438.57232-.58292.86378-1.2877.87438-2.1144.010599-.82666-.28086-1.5262-.87438-2.0985-.59352-.57232-1.293-.86378-2.0985-.87438-.8055-.010599-1.5103.28086-2.1144.87438-.60414.59352-.8956 1.293-.87438 2.0985.021197.8055.31266 1.5103.87438 2.1144.56172.60414 1.2665.8956 2.1144.87438zm4.4695.2115 3.681 3.6819-1.259 1.284-3.6817-3.7.0019784-.69479-.090043-.098846c-.87973.76087-1.92 1.1413-3.1207 1.1413-1.3553.0-2.5025-.46363-3.4417-1.3909s-1.4088-2.0686-1.4088-3.4239.4696-2.4966 1.4088-3.4239c.9392-.92727 2.0864-1.3969 3.4417-1.4088 1.3553-.011889 2.4906.45771 3.406 1.4088.9154.95107 1.379 2.0924 1.3909 3.4239.0 1.2126-.38043 2.2588-1.1413 3.1385l.098834.090049z"/></svg></button></nav></div><script>function search(){const search_value=document.getElementById("search_input").value;if(search_value!==''){window.open("/search/?q="+search_value,"_blank");}}
document.getElementById("search_input").addEventListener("keydown",function(e){if(e.key==="Enter"){search()}});</script></span></div></section><div id=content><section class="article header"><h1 class="article title">VMware虚拟机Kali连接ACR122U遇到的各种坑总结</h1><p class="article date"><span class=lang><a>Hzllaga</a> </span>Monday, April 8, 2019</p></section><article class="article markdown-body"><p>Kali安装过程就省略不说了，直接讲怎么连接，这部分网上还是比较少的，都是PN532比较多
驱动直接去官网找acr122u-nfc读写器-usb接口的<a href=https://www.acs.com.hk/download-driver-unified/10476/ACS-Unified-PKG-Lnx-116-P.zip target=_blank>PC/SC 驱动包装</a></p><p>然后直接用apt安装一下libtool<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo apt install libtool</code></pre></div></p><p>接着连接后你会发现执行nfc-list卡在那边没反应</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200223175740.png><img src=https://cdn.wtfsec.org/img/20200223175740.png alt></a></p><p>接着设备移除后变这样</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200223175750.png><img src=https://cdn.wtfsec.org/img/20200223175750.png alt></a></p><p>原因是内核版本(>3.5)会自动加载pn533驱动导致报错</p><p>解决方法很简单，首先执行<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>lsmod</code></pre></div>看看哪些驱动被安装了</p><p>常见的就这几种 pn533_usb,pn533,pn533_usb,nfc</p><p>再来就把这几个模块给移除掉，会导致读卡机灯熄灭，不过不影响操作</p><p><div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>	
sudo modprobe -r pn533_usb pn533 nfc</code></pre></div>然后把这几个加入黑名单<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>sudo vi /etc/modprobe.d/blacklist-libnfc.conf</code></pre></div>加上<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>	
blacklist nfc
blacklist pn533
blacklist pn533_usb</code></pre></div></p><p>然后重新执行nfc-list，就会发现正常读取了，并且读卡机会亮红灯</p><hr>如果是提示No NFC device found这种情况的话<p>是因为VMware在新版是使用共享ccid的方式，导致libnfc无法读取，不过pcsc_scan是可以正常读取的</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200223175921.jpg><img src=https://cdn.wtfsec.org/img/20200223175921.jpg alt></a></p><p>这种方式VMware官方给出的方式还是比较简单粗暴的</p><p>关闭虚拟机后直接修改这个虚拟机的vmx文件，添加上这两句<div class=highlight><pre class=chroma><code class=language-shell data-lang=shell>	
usb.generic.allowCCID <span class=o>=</span> <span class=s2>&#34;TRUE&#34;</span>
usb.ccid.disable <span class=o>=</span> <span class=s2>&#34;TRUE&#34;</span></code></pre></div>然后开机就可以直接用USB直通模式把读卡机连接进去了</p><p><a target=_blank rel="noopener noreferrer" href=https://cdn.wtfsec.org/img/20200223175952.jpg><img src=https://cdn.wtfsec.org/img/20200223175952.jpg alt></a></p><p>接下来会遇到的问题就在上面了，折腾我2天就TM只是驱动问题= =</p><section class="article labels"><a class=category href=/categories/%E5%8E%9F%E5%88%9B/>原创</a><a class=tag href=/tags/linux/>Linux</a><a class=tag href=/tags/kali/>Kali</a><a class=tag href=/tags/ic/>IC</a></section></article><div class="article navigation"><p><a class=link href=/posts/red-alert-pwn-challenges-write-up/><span class=li>&larr;</span>Red Alert Pwn Challenges Write Up</a><p><a class=link href=/posts/msf5%E4%B8%80%E4%BA%9B%E7%89%B9%E8%89%B2%E4%BB%A5%E5%8F%8A%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E5%85%B6%E5%85%8D%E6%9D%80/><span class=li>&rarr;</span>MSF5一些特色以及如何使用其免杀</a></p></div></div><section id=footer class=footer><div class=footer-wrap><p class=copyright>©2014-2020 WTFSec.</p><p class=powerby><span>Powered by </span><a href=https://gohugo.io target=_blank>Hugo</a><span> and the </span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p><p class=powerby><span>CDN by </span><a href=https://cf.wtfsec.org target=_blank>Cloudflare</a><span> and </span><a href="https://console.upyun.com/register/?invite=H1xhvqTVV" target=_blank>又拍云</a></p></div></section><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-83215806-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script data-ad-client=ca-pub-4220670081232153 async src=https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script></div></body></html>